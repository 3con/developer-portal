<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="author" content="Keboola">
        <title>UI Applications settings | Keboola Connection</title>
        <link href="https://d3qqa9wia2dvbu.cloudfront.net/v0.4.1-0-g11454af/css/kbc.css" media="screen" rel="stylesheet" type="text/css" >
        <script type="text/javascript">
          window.onload = () => {
            ajaxGet('https://d0o4qyku4c.execute-api.us-east-1.amazonaws.com/prod/apps')
              .then((data) => {
                document.getElementsByClassName('kbc-main-loader')[0].setAttribute('hidden', 'hidden');
                document.getElementsByClassName('kbc-search')[0].removeAttribute('hidden');
                document.getElementsByClassName('kbc-components-overview')[0].removeAttribute('hidden');
                document.getElementsByClassName('kbc-help')[0].removeAttribute('hidden');

                const jsonData = JSON.parse(data);
                let row = addRow();
                let counter = 0;
                for (i = 0; i < jsonData.length; i++) {
                  addAppBox(row, jsonData[i].icon[64], jsonData[i].name, jsonData[i].shortDescription);
                  counter++;
                  if (counter >= 3) {
                    row = addRow();
                    counter = 0;
                  }
                }
              });
          };
          function addRow() {
            const rowTag = document.createElement('div');
            rowTag.setAttribute('class', 'tr');
            document.getElementsByClassName('tbody')[0].appendChild(rowTag);
            return rowTag;
          }
          function addAppBox(row, icon, title, description) {
            const appTag = document.createElement('div');
            appTag.setAttribute('class', 'td');
            const imgTag = document.createElement('img');
            if (icon) {
              imgTag.setAttribute('src', icon);
            }
            const imgSpanTag = document.createElement('span');
            imgSpanTag.setAttribute('class', 'kb-sapi-component-icon');
            const h2Tag = document.createElement('h2');
            h2Tag.textContent = title;
            const pTag = document.createElement('p');
            pTag.textContent = description;
            const aTag = document.createElement('a');
            const buttonTag = document.createElement('button');
            buttonTag.setAttribute('class', 'btn btn-success');
            buttonTag.textContent = 'More';

            imgSpanTag.appendChild(imgTag);
            appTag.appendChild(imgSpanTag);
            appTag.appendChild(h2Tag);
            appTag.appendChild(pTag);
            aTag.appendChild(buttonTag);
            appTag.appendChild(aTag);
            row.appendChild(appTag);
          }
          function ajaxGet(url) {
            return new Promise(function(resolve, reject) {
              let req = new XMLHttpRequest();
              req.open("GET", url);
              req.onload = function() {
                if (req.status === 200) {
                  resolve(req.response);
                } else {
                  reject(new Error(req.statusText));
                }
              };

              req.onerror = function() {
                reject(new Error("Network error"));
              };

              req.send();
            });
          }
        </script>
    </head>
    <body class="kbc-single-page kbc-admin-module">
        <nav class="navbar navbar-fixed-top kbc-navbar" role="navigation">
            <div class="col-xs-10">
                <div>
                    <div class="kbc-logo col-xs-6">
                        <a href="/"><span class="kbc-icon-keboola-logo"></span></a>
                    </div>
                </div>
            </div>
        </nav>
        <div class="container-fluid col-xs-10">
            <div class="kbc-header">
                <div class="kbc-title">
                    <h1 style="margin:1em 0 .7em 90px;">Apps Portal</h1>
                    <p style="margin:1em 0 .7em 90px;">Look through all the services Keboola can connect to</p>
                </div>
            </div>
            <div class="kbc-main">
                <div class="container-fluid kbc-main-content">
                    <div class="kbc-main-loader">
                        <span class="text-muted">Loading ...</span>
                    </div>
                    <form class="kbc-search row kbc-search-row" hidden="hidden">
                        <span class="kbc-icon-search"></span>
                        <input type="text" value="" class="form-control" placeholder="Search">
                    </form>
                    <div class="table kbc-table-border-vertical kbc-components-overview kbc-layout-table" hidden="hidden">
                        <div class="tbody">

                        </div>
                    </div>
                    <div class="row kbc-help" hidden="hidden">
                        <div class="text-center">
                            <h2>Haven't found what you were looking for?</h2>
                            <a class="btn btn-primary" href="mailto:support@keboola.com">Let us know</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>